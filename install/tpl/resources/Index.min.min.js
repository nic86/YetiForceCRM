
jQuery.Class("Install_Index_Js",{},{registerEventForStep1:function(){jQuery(".bt_install").on("click",function(b){jQuery('input[name="mode"]').val("Step2");jQuery('form[name="step1"]').submit()});jQuery(".bt_migrate").on("click",function(b){jQuery('input[name="mode"]').val("mStep0");jQuery('form[name="step1"]').submit()})},registerEventForStep3:function(){jQuery("#recheck").on("click",function(){window.location.reload()});jQuery('input[name="step4"]').on("click",function(d){var e=jQuery(".no");if(e.length>0){var f=app.vtranslate("LBL_PHP_WARNING");if(confirm(f)){jQuery('form[name="step3"]').submit();return true}else{return false}}jQuery('form[name="step3"]').submit()})},checkPwdEvent:function(){var b=this;jQuery('input[name="password"]').on("blur",function(){b.checkPwd(jQuery(this).val())})},checkPwd:function(c){var d=false;if(c.length<8){jQuery("#passwordError").html(app.vtranslate("LBL_PASS_TO_SHORT"));d=true}else{if(c.length>32){jQuery("#passwordError").html(app.vtranslate("LBL_PASS_TO_LONG"));d=true}else{if(c.search(/\d/)==-1){jQuery("#passwordError").html(app.vtranslate("LBL_PASS_NO_NUM"));d=true}else{if(c.search(/[A-Z]/)==-1){jQuery("#passwordError").html(app.vtranslate("LBL_PASS_LACK_OF_CAPITAL_LETTERS"));d=true}else{if(c.search(/[a-z]/)==-1){jQuery("#passwordError").html(app.vtranslate("LBL_PASS_LACK_OF_LOWERCASE_LETTERS"));d=true}}}}}return d},registerEventForStep4:function(){var g=JSON.parse(localStorage.getItem("yetiforce_install"));for(var j in g){var k=jQuery('[name="'+j+'"]');if("SELECT"==jQuery(k).prop("tagName")){jQuery(k).val(g[j]);jQuery(k).select2("destroy");jQuery(k).select2()}else{if("INPUT"==jQuery(k).prop("tagName")&&"checkbox"==jQuery(k).attr("type")){if(true==g[j]){jQuery(k).prop("checked",true);jQuery(".config-table tr.hide").removeClass("hide")}}else{jQuery(k).val(g[j])}}}var l=this;jQuery('input[name="create_db"]').on("click",function(){var a=jQuery("#root_user");var b=jQuery("#root_password");if(jQuery(this).is(":checked")){a.removeClass("hide");b.removeClass("hide")}else{a.addClass("hide");b.addClass("hide")}});function i(){jQuery("#passwordError").html("")}function h(){jQuery("#passwordError").html(app.vtranslate("LBL_PASS_REENTER_ERROR"))}jQuery('input[name="retype_password"]').on("blur",function(a){var b=jQuery(a.currentTarget);var c=jQuery('input[name="password"]').val();if(c!==b.val()){h()}});jQuery('input[name="password"]').on("blur",function(a){var b=jQuery('input[name="retype_password"]');if(b.val()!=""&&b.val()!==jQuery(a.currentTarget).val()){jQuery("#passwordError").html(app.vtranslate("LBL_PASS_REENTER_ERROR"))}else{i()}});jQuery('input[name="retype_password"]').on("keypress",function(a){i()});jQuery('input[name="step5"]').on("click",function(){var v=false;var y=["db_hostname","db_username","db_name","password","retype_password","lastname","admin_email"];for(var a in y){var d=jQuery('input[name="'+y[a]+'"]');if(d.val()==""){d.addClass("error").focus();v=true;break}else{d.removeClass("error")}}var z=jQuery('input[name="create_db"]:checked');if(z.length>0){var f=jQuery('input[name="db_root_username"]');if(f.val()==""){f.addClass("error").focus();v=true}else{f.removeClass("error")}}var c=jQuery("#passwordError");if(c.html().trim()){v=true}var b=jQuery('input[name="admin_email"]');var e=/^[_/a-zA-Z0-9*]+([!"#$%&'()*+,./:;<=>?\^_`{|}~-]?[a-zA-Z0-9/_/-])*@[a-zA-Z0-9]+([\_\-\.]?[a-zA-Z0-9]+)*\.([\-\_]?[a-zA-Z0-9])+(\.?[a-zA-Z0-9]+)?$/;if(!e.test(b.val())&&b.val()!=""){var t=true;b.addClass("error").focus();v=true}else{b.removeClass("error")}var u=false;u=l.checkPwd(jQuery('input[name="password"]').val());if(u){v=true}if(v){var w;if(t){w='<div class="span12"><div class="alert alert-error"><button class="close" data-dismiss="alert" type="button">x</button>'+jQuery('[name="invalidEmailError"]').val()+"</div></div>"}else{if(u){w='<div class="span12"><div class="alert alert-error"><button class="close" data-dismiss="alert" type="button">x</button>'+jQuery('[name="insufficientlyStrongPassword"]').val()+"</div></div>"}else{w='<div class="span12"><div class="alert alert-error"><button class="close" data-dismiss="alert" type="button">x</button>'+app.vtranslate("LBL_MANDATORY_FIELDS_ERROR")+"</div></div>"}}jQuery("#errorMessage").html(w).show()}else{var x={db_hostname:document.step4.db_hostname.value,db_username:document.step4.db_username.value,db_name:document.step4.db_name.value,create_db:jQuery('[name="create_db"]').prop("checked"),db_root_username:document.step4.db_root_username.value,currency_name:document.step4.currency_name.value,firstname:document.step4.firstname.value,lastname:document.step4.lastname.value,admin_email:document.step4.admin_email.value,dateformat:document.step4.dateformat.value,timezone:document.step4.timezone.value};window.localStorage.setItem("yetiforce_install",JSON.stringify(x));jQuery('form[name="step4"]').submit()}});this.checkPwdEvent()},registerEventForStep5:function(){jQuery('input[name="step6"]').on("click",function(){var b=jQuery("#errorMessage");if(b.length){alert(app.vtranslate("LBL_RESOLVE_ERROR"));return false}else{jQuery("#progressIndicator").removeClass("hide");jQuery('form[name="step5"]').submit().hide()}})},registerEventForStep6:function(){jQuery('input[name="step7"]').on("click",function(){var b=jQuery('select[name="industry"]').val();if(b.length<1){alert(jQuery('[name="selectIndustry"]').val())}else{jQuery("#progressIndicator").show();jQuery('form[name="step6"]').submit().hide()}})},registerEventForMigration:function(){var b=jQuery('input[name="mode"]').val();if(b=="mStep3"){jQuery("form").on("submit",function(){jQuery("#progressIndicator").show();jQuery("#mainContainer").hide()})}},changeLanguage:function(c){var d=$(c.currentTarget);jQuery('input[name="mode"]').val("");jQuery('form[name="step1"]').submit()},registerEvents:function(){jQuery('input[name="back"]').on("click",function(){var b=jQuery('input[name="create_db"]:checked');if(b.length>0){jQuery('input[name="create_db"]').removeAttr("checked")}window.history.back()});this.registerEventForStep1();this.registerEventForStep3();this.registerEventForStep4();this.registerEventForStep5();this.registerEventForStep6();this.registerEventForMigration();$('select[name="lang"]').change(this.changeLanguage)}});jQuery(document).ready(function(){var b=new Install_Index_Js();b.registerEvents()});