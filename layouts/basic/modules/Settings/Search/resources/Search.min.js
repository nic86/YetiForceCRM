
var Settings_Index_Js={updatedBlockFieldsList:[],initEvants:function(){$(".SearchFieldsEdit .fieldname").change(Settings_Index_Js.save);$(".SearchFieldsEdit .searchcolumn").change(Settings_Index_Js.save);$(".SearchFieldsEdit .updateLabels").click(Settings_Index_Js.updateLabels);$(".SearchFieldsEdit .turn_off").click(Settings_Index_Js.replacement)},replacement:function(c){var a=this;var b=$(c.currentTarget);if(parseInt(b.val())){b.val(0).html(app.vtranslate("JS_TURN_ON"));b.removeClass("btn-success").addClass("btn-danger")}else{b.val(1).html(app.vtranslate("JS_TURN_OFF"));b.removeClass("btn-danger").addClass("btn-success")}Settings_Index_Js.save(c)},updateLabels:function(d){var c=$(d.currentTarget);var a=c.closest("tr");if(!a.hasClass("ui-sortable-handle")){a=a.prev()}var b=$.progressIndicator({message:app.vtranslate("Update labels"),blockInfo:{enabled:true}});Settings_Index_Js.registerSaveEvent("UpdateLabels",{tabid:a.data("tabid"),});b.progressIndicator({mode:"hide"})},save:function(g){var f=$(g.currentTarget);var c=f.attr("name");var d=f.val();f.trigger("chosen:updated");if(d.length==1){app.getChosenElementFromSelect(f).find(".search-choice-close").remove()}var a=f.closest("tr");var b=$.progressIndicator({message:app.vtranslate("Saving changes"),blockInfo:{enabled:true}});Settings_Index_Js.registerSaveEvent("Save",{name:c,value:d,tabid:a.data("tabid"),});b.progressIndicator({mode:"hide"})},registerSaveEvent:function(d,a){var c="";var b={};b.data={module:app.getModuleName(),parent:app.getParentModuleName(),action:"SaveAjax",mode:d,params:a};b.async=false;b.dataType="json";AppConnector.request(b).then(function(f){var e=f.result;var g={text:e.message,animation:"show",type:"success"};Vtiger_Helper_Js.showPnotify(g);c=e.success},function(f,e){})},makeFieldsListSortable:function(){var c=this;var b=jQuery(".SearchFieldsEdit").find(".contents");var a=b.find("table");a.each(function(){jQuery(this).find("tbody").sortable({containment:"#modulesEntity",revert:true,tolerance:"pointer",cursor:"move",helper:function(f,d){d.children().each(function(e,g){g=jQuery(g);g.width(g.width())});return d},update:function(f,d){c.showSaveModuleSequenceButton()}})})},showSaveModuleSequenceButton:function(){var b=this;var a=jQuery(".SearchFieldsEdit");var c=a.find(".saveModuleSequence");b.updatedBlockFieldsList=[];c.removeClass("hide")},hideSaveModuleSequenceButton:function(){var a=jQuery(".SearchFieldsEdit");var b=a.find(".saveModuleSequence");b.addClass("hide")},updateModulesSequence:function(){var a=this;var b=jQuery.progressIndicator({position:"html",blockInfo:{enabled:true}});var c={};c.module=app.getModuleName();c.parent=app.getParentModuleName();c.action="SaveAjax";c.mode="SaveSequenceNumber";c.updatedFields=a.updatedBlockFieldsList;AppConnector.request(c).then(function(d){b.progressIndicator({mode:"hide"});var e={};e.text=app.vtranslate("JS_MODULES_SEQUENCE_UPDATED");Settings_Vtiger_Index_Js.showMessage(e)},function(d){b.progressIndicator({mode:"hide"})})},createUpdatedSequenceModulesList:function(){var e=this;var d=jQuery(".SearchFieldsEdit").find(".contents");var a=d.find("tbody");var c=a.find("tr");var b=1;c.each(function(g,j){var f=jQuery(j);var h=f.data("tabid");e.updatedBlockFieldsList.push({tabid:h,sequence:b});b=b+1})},registerModuleSequenceSaveClick:function(){var b=this;var a=jQuery(".SearchFieldsEdit");a.on("click",".saveModuleSequence",function(){b.hideSaveModuleSequenceButton();b.createUpdatedSequenceModulesList();b.updateModulesSequence()})},checkCountItems:function(a){a.each(function(c){var b=jQuery(this).val();if(b&&b.length==1){app.getChosenElementFromSelect(jQuery(this)).find(".search-choice-close").remove()}})},registerEvents:function(){Settings_Index_Js.initEvants();this.makeFieldsListSortable();this.registerModuleSequenceSaveClick();this.checkCountItems($(".SearchFieldsEdit .fieldname"));this.checkCountItems($(".SearchFieldsEdit .searchcolumn"))}};$(document).ready(function(){Settings_Index_Js.registerEvents()});